(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.QuadMenu||(this.Maslosoft.QuadMenu={}),this.Maslosoft.QuadMenu.Options=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c}var b;return a.prototype.region="document",a.prototype.event="mousedown",b=!1,a.prototype.quads=[],a}(),this.Maslosoft.QuadMenu.Item=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c}return a.prototype.title="",a.prototype.href="",a.prototype.menu="",a.prototype.setMenu=function(a){this.menu=a},a.prototype.onClick=function(){return this.click},a.prototype.getTitle=function(){return this.title},a.prototype.setTitle=function(a){this.title=a},a.prototype.getHref=function(){return"#"},a}(),this.Maslosoft.QuadMenu.Quad=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c}return a.prototype.title="",a.prototype.items=[],a.prototype.setTitle=function(a){this.title=a},a.prototype.getTitle=function(){return this.title},a.prototype.getItems=function(){},a.prototype.getPreferred=function(){return-1},a.prototype.isVisible=function(){return!0},a.prototype.inRegion=function(){return null},a}(),this.Maslosoft.QuadMenu.Renderer=function(){function b(b){var c,d,e;for(this.menu=b,this.add=a(this.add,this),this.close=a(this.close,this),this.open=a(this.open,this),this.container=jQuery('<div class="maslosoft-quad-menu"></div>'),d=c=0;4>c;d=++c)e=jQuery("<ul class='quad-"+d+"' />"),this.quads.push(e),this.container.append(e);jQuery("body").append(this.container)}return b.prototype.menu=null,b.prototype.container=null,b.prototype.quads=[],b.prototype.open=function(a,b){return this.container.css("left",a),this.container.css("top",b),this.container.show()},b.prototype.close=function(){return this.container.hide()},b.prototype.add=function(a,b,c){var d,e,f,g,h;c.getTitle()&&this.quads[a].append("<li class='quad-title'>"+c.getTitle()+"</li>"),g=c.items,h=[];for(f in g)d=g[f],d.setMenu(this.menu),e='<li>\n	<a href="'+d.getHref()+'" \n		data-item-id="'+f+'"\n		data-menu-id="'+b+'"\n		data-quad-id="'+a+'"	\n		>\n		'+d.getTitle()+"\n	</a>\n</li>",1===a||2===a?h.push(this.quads[a].prepend(e)):h.push(this.quads[a].append(e));return h},b}(),this.Maslosoft.QuadMenu.Menu=function(){function b(b){var c,d,e,f;for(null==b&&(b={}),this.close=a(this.close,this),this.open=a(this.open,this),this.stop=a(this.stop,this),this.preventContext=a(this.preventContext,this),this.onClick=a(this.onClick,this),this.options=new Maslosoft.QuadMenu.Options(b),this.renderer=new Maslosoft.QuadMenu.Renderer(this),console.log(this.options),f=this.options.quads,c=0,d=f.length;d>c;c++)e=f[c],this.add(e);console.log(this.options.region),"document"===this.options.region?(jQuery(document).on(this.options.event,this.onClick),jQuery(document).on("contextmenu",this.preventContext)):(jQuery(document).on(this.options.event,this.options.region,this.onClick),jQuery(document).on("contextmenu",this.options.region,this.preventContext)),this.renderer.container.on(this.options.event,this.stop),this.renderer.container.on("click",this.prevent),jQuery(document).on("keydown",function(a){return function(b){return 27===b.keyCode?a.close():void 0}}(this))}return b.prototype.options=null,b.prototype.quads=[[],[],[],[]],b.prototype.menu=null,b.prototype.renderer=null,b.prototype.onClick=function(a){return console.log(a),3!==a.which?this.close():(this.open(a.clientX,a.clientY),this.options.browserContext?void 0:a.preventDefault())},b.prototype.preventContext=function(a){return a.preventDefault(),this.options.browserContext?void 0:a.preventDefault()},b.prototype.stop=function(a){var b,c,d,e;return b=jQuery(a.target).data(),e=this.quads[b.quadId],e&&(d=e[b.menuId]),d&&(c=d.items[b.itemId]),c&&console.log(c.onClick(a,c)),a.stopPropagation()},b.prototype.prevent=function(a){return a.preventDefault()},b.prototype.open=function(a,b){return this.renderer.open(a,b)},b.prototype.close=function(){return this.renderer.close()},b.prototype.add=function(a){var b,c,d,e,f,g,h,i,j;if(g=parseInt(a.getPreferred()),-1>g||g>3)throw new Error("Preferred quad must be between -1 and 3");for(g>=0&&this.quads[g].push(a),j=b=0;4>b;j=++b)for(i=this.quads,c=d=0,e=i.length;e>d;c=++d)if(h=i[c],console.log(a),h.length===j)return f=h.push(a),void this.renderer.add(c,f-1,a)},b}()}).call(this);
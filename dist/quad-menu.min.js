(function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty,c=function(a,b){return function(){return a.apply(b,arguments)}};this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.QuadMenu||(this.Maslosoft.QuadMenu={}),this.Maslosoft.QuadMenu.Options=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c}var b;return a.prototype.region="document",a.prototype.showSpot=!0,a.prototype.event="mousedown",b=!1,a.prototype.menus=[],a}(),this.Maslosoft.QuadMenu.ItemBase=function(){function a(a){var b,c;null==a&&(a={}),this.reset();for(b in a)c=a[b],this[b]=c}return a.prototype.id=0,a.prototype.parent=null,a.prototype.length=0,a.prototype.visible=!0,a.prototype.items=[],a.prototype.add=function(a){var b;return this.length++,this.items.push(a),b=this.length-1,a.id=b,a.parent=this,b},a.prototype.reset=function(){return this.parent=null,this.length=0,this.items=new Array},a.prototype.get=function(a){return this.items[a]?this.items[a]:null},a.prototype.getItems=function(){return this.items},a.prototype.isVisible=function(a){return null==a&&(a=null),null!==a&&(this.visible=a),this.visible},a.prototype.inRegion=function(){return null},a}(),this.Maslosoft.QuadMenu.Item=function(b){function c(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c}return a(c,b),c.prototype.title="",c.prototype.href="",c.prototype.menu="",c.prototype.setMenu=function(a){this.menu=a},c.prototype.onClick=function(){return this.click},c.prototype.getTitle=function(){return this.title},c.prototype.setTitle=function(a){this.title=a},c.prototype.getHref=function(){return"#"},c}(this.Maslosoft.QuadMenu.ItemBase),this.Maslosoft.QuadMenu.Menu=function(b){function c(a){var b,d,e,f,g;if(null==a&&(a={}),c.__super__.constructor.call(this,a),a.items)for(this.reset(),g=a.items,d=b=0,f=g.length;f>b;d=++b)e=g[d],e=new Maslosoft.QuadMenu.Item(e),this.add(e)}return a(c,b),c.prototype.title="",c.prototype.setTitle=function(a){this.title=a},c.prototype.getTitle=function(){return this.title},c.prototype.getPreferred=function(){return-1},c}(this.Maslosoft.QuadMenu.ItemBase),this.Maslosoft.QuadMenu.Quad=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c}(this.Maslosoft.QuadMenu.ItemBase),this.Maslosoft.QuadMenu.QuadMenu=function(){function a(a){var b,d,e,f,g,h;for(null==a&&(a={}),this.close=c(this.close,this),this.open=c(this.open,this),this.preventContext=c(this.preventContext,this),this.itemClick=c(this.itemClick,this),this.regionClick=c(this.regionClick,this),this.quads=new Array,this.options=new Maslosoft.QuadMenu.Options(a),this.renderer=new Maslosoft.QuadMenu.Renderer(this),d=b=0;4>b;d=++b)this.quads[d]=new Maslosoft.QuadMenu.Quad({id:d});for(h=this.options.menus,e=0,f=h.length;f>e;e++)g=h[e],this.add(g);"document"===this.options.region?(jQuery(document).on(this.options.event,this.regionClick),jQuery(document).on("contextmenu",this.preventContext)):(jQuery(document).on(this.options.event,this.options.region,this.regionClick),jQuery(document).on("contextmenu",this.options.region,this.preventContext)),this.renderer.container.on(this.options.event,this.itemClick),this.renderer.container.on("click",this.prevent),jQuery(document).on("keydown",function(a){return function(b){return 27===b.keyCode?a.close():void 0}}(this))}return a.prototype.options=null,a.prototype.quads=[],a.prototype.menu=null,a.prototype.renderer=null,a.prototype.regionClick=function(a){return 3!==a.which?this.close():(this.open(a.clientX,a.clientY),this.options.browserContext?void 0:a.preventDefault())},a.prototype.itemClick=function(a){var b,c;return b=jQuery(a.target).data(),c=this.getItem(b),c&&c.onClick(a,c),a.stopPropagation()},a.prototype.preventContext=function(a){return a.preventDefault(),this.options.browserContext?void 0:a.preventDefault()},a.prototype.prevent=function(a){return a.preventDefault()},a.prototype.getItem=function(a){var b;return b=this.getMenu(a),b?b.get(a.itemId):null},a.prototype.getMenu=function(a){var b;return b=this.getQuad(a),b?b.get(a.menuId):null},a.prototype.getQuad=function(a){return this.quads[a.quadId]?this.quads[a.quadId]:null},a.prototype.open=function(a,b){return this.renderer.open(a,b)},a.prototype.close=function(){return this.renderer.close()},a.prototype.add=function(a,b){var c,d,e,f,g,h;if(null==b&&(b=-1),b>=0&&(b=parseInt(a.getPreferred())),-1>b||b>3)throw new Error("Preferred quad must be between `-1` and `3`");for(b>=0&&this.quads[b].items.push(a),h=c=0;4>c;h=++c)for(g=this.quads,d=0,e=g.length;e>d;d++)if(f=g[d],f.length===h)return f.add(a),void this.renderer.add(f,a)},a}(),this.Maslosoft.QuadMenu.Renderer=function(){function a(a){var b,d,e;for(this.menu=a,this.add=c(this.add,this),this.close=c(this.close,this),this.open=c(this.open,this),this.quads=new Array,this.menus=new Array,this.items=new Array,this.container=jQuery('<div class="maslosoft-quad-menu"></div>'),this.menu.options.showSpot&&this.container.append('<div class="quad-spot" /> '),e=b=0;4>b;e=++b)d=jQuery("<div class='quad-"+e+"' />"),this.quads[e]=d,this.menus[e]=new Array,this.items[e]=new Array,this.container.append(d);jQuery("body").append(this.container)}return a.prototype.menu=null,a.prototype.container=null,a.prototype.quads=[],a.prototype.menus=[],a.prototype.items=[],a.prototype.open=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(this.container.css("left",a),this.container.css("top",b),this.container.show(),r=this.menu.quads,u=[],q=c=0,i=r.length;i>c;q=++c){for(o=r[q],p=this.getQuad(q),w=0,s=o.items,n=g=0,j=s.length;j>g;n=++g){for(l=s[n],m=this.getMenu(q,n),v=0,t=l.items,f=h=0,k=t.length;k>h;f=++h)d=t[f],e=this.getItem(q,n,f),v+=this.setVisibilityOf(d,e);0===v?m.hide():w+=this.setVisibilityOf(l,m)}0===w&&p.hide(),u.push(this.setVisibilityOf(o,p))}return u},a.prototype.setVisibilityOf=function(a,b,c,d){var e,f;return null==c&&(c=null),null==d&&(d=null),f=a.isVisible(),e=b.is(":visible"),f?(b.show(),1):f?void 0:(b.hide(),0)},a.prototype.close=function(){return this.container.hide()},a.prototype.getItem=function(a,b,c){if(a>3||0>a)throw new Error("Bad quad id must be in `0 ... 3` however `"+a+"` given");return this.items[a][b][c]},a.prototype.getMenu=function(a,b){if(a>3||0>a)throw new Error("Bad quad id must be in `0 ... 3` however `"+a+"` given");return this.menus[a][b]},a.prototype.getQuad=function(a){if(a>3||0>a)throw new Error("Bad quad id must be in `0 ... 3` however `"+a+"` given");return this.quads[a]},a.prototype.add=function(a,b){var c,d,e,f,g,h,i,j;h=a.id,g=b.id,this.items[h][g]||(this.items[h][g]=[]),f=jQuery('<ul data-menu-id="'+g+'" /> '),this.menus[h][g]=f,b.getTitle()&&f.append('<li class="menu-title"\n	data-menu-id="'+g+'"\n	data-quad-id="'+h+'"\n	>\n	'+b.getTitle()+"\n</li>"),i=b.items,j=[];for(e in i)c=i[e],c.setMenu(this.menu),d=jQuery('<li>\n	<a href="'+c.getHref()+'"\n		data-item-id="'+e+'"\n		data-menu-id="'+g+'"\n		data-quad-id="'+h+'"\n		>\n		'+c.getTitle()+"\n	</a>\n</li>"),f.append(d),this.items[h][g][e]=d,1===h||2===h?j.push(this.quads[h].prepend(f)):j.push(this.quads[h].append(f));return j},a}()}).call(this);